
Notes to be elaborated
----------------------

OnePlus 5T/6 installation

From the UT installer onwards..

 > = laptop
 * = phablet shiterm
 $ = phablet

 # set screen timeout
 # set date/time to auto
 - --
 > set up op5t/op6 host/IP in /etc/hosts
 * mkdir .ssh
 * nc -l 1234 > ~/.ssh/authorized_keys
 > nc op5t/op6 1234 < ~/.ssh/id_rsa.pub
 * chmod 700 .ssh; chmod 600 .ssh/authorized_keys
 * service ssh start
 > ssh phablet@op5t/op6 - get in without password
 $ sudo vi /etc/init/ssh.override - remove "manual"
 # or for Focal (doesn't work of course, like everything else in Focal)
 $ sudo systemctl enable ssh
 > restart phone
 $ service ssh status / start (grr)
 > ssh phablet@op5t/op6 - sshd running?
 - --
 > cd .../OnexOS
 > scp ./docs/bashrc phablet@op6:bashrc
 $ vi -o -N bashrc .bashrc # add first bits plus what you like from bashrc to top of .bashrc
 $ log out and back in

ssh on boot
-----------

~/Sources/halium-build/halium-install/functions/distributions.sh

sudo sed -i 's/PasswordAuthentication=no/PasswordAuthentication=yes/g' "$ROOTFS_DIR/etc/init/ssh.override"
sudo sed -i 's/manual/start on startup/g' "$ROOTFS_DIR/etc/init/ssh.override"
sudo sed -i 's/manual/start on startup/g' "$ROOTFS_DIR/etc/init/usb-tethering.conf"

sudo vi /etc/init/ssh.override: remove manual    -- no go
android-gadget-service enable ssh                -- no go
sudo setprop persist.service.ssh true            -- no go
sudo vi /etc/init/ssh.override: start on startup -- no go


Only thing that works is hacking it in ourselves:

phablet@ubuntu-phablet:~$ cat scripts/run-sshd.sh
#!/usr/bin/env bash
android-gadget-service enable ssh

phablet@ubuntu-phablet:~$ ./scripts/run-sshd.sh
ssh enabled

phablet@ubuntu-phablet:~$ cat .config/upstart/ssh.conf
description "Enable SSH"
start on started unity8
exec /home/phablet/scripts/run-sshd.sh



----------------------------------



Needs a cross-build of libhybris with the patches applied

 - install Android headers Pie 9 API level 28
 - patch and cross-compile libhybris
 - if installed, replace o.so with original (i.e. don't "make install" over it?)

 > scp ./built/libhybris-platformcommon.so.1       phablet@op5t:onx/
 > scp ./built/libvulkan.so.1                      phablet@op5t:onx/
 > scp ./built/libhybris-vulkanplatformcommon.so.1 phablet@op5t:onx/
 > scp ./built/vulkanplatform_null.so              phablet@op5t:onx/
 > scp ./built/cdc-acm.ko                          phablet@op5t:onx/

 > Make copy-op5t/copy-op6

 $ cd onx
 $ rw (bash alias to make mount r/w)
 $ sudo mkdir -p                               /opt/libhybris/lib/libhybris
 $ sudo mv libhybris-platformcommon.so.1       /opt/libhybris/lib
 $ sudo mv libvulkan.so.1                      /opt/libhybris/lib
 $ sudo mv libhybris-vulkanplatformcommon.so.1 /opt/libhybris/lib
 $ sudo mv vulkanplatform_null.so              /opt/libhybris/lib/libhybris

 $ sudo insmod cdc-acm.ko

 $ dm stop (bash alias sudo service lightdm)
 $ cd onx; ldd onx-arm | grep not.found
 $ ./onx-arm






